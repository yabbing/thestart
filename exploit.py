import hmac, hashlib
import base64

key = '8929874489719802418902487651347865819634518936754'

def sign(msg, key=key):
    cookie_val = base64.urlsafe_b64decode(msg)
    cookie = "download_session=" + cookie_val

    return hmac.new(key, msg=cookie, digestmod=hashlib.sha1).hexdigest()

print(sign({"flashes":{"info":[],"error":[],"success":[]},"user":{"id":16,"username":"yabbing"}}))