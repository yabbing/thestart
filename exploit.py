import hmac, hashlib
import base64

key = '8929874489719802418902487651347865819634518936754'

def sign(msg, key=key):
    cookie_val = base64.urlsafe_b64decode(msg.encode())
    cookie = b"download_session=" + cookie_val
    signed = hmac.new(key.encode(), msg=cookie, digestmod=hashlib.sha1).digest()
    return base64.urlsafe_b64decode(signed)

print(sign('{"flashes":{"info":[],"error":[],"success":[]},"user":{"id":16,"username":"yabbing"}}'))